<?xml version="1.0" encoding="UTF-8"?>

<!-- 
    This file contains definitions to standalone subsystems, or services, used by the IdP.  These 
    services include things such as the attribute resolver and filtering engines as well as the 
    relying party configuration manager.
    
    Reloadable services (profile handler manager, relying party configuration manager, attribute resolver, and 
    attribute filtering engine) can be configured to poll their configuration files on a given frequency and 
    reload those files if they've changed.  Enable this feature by adding an attribute, on the Service element, 
    named configurationResourcePollingFrequency whose value is the frequency, in milliseconds, to poll the file(s).
    A second attribute, configurationResourcePollingRetryAttempts, specifies the number of times a particular 
    configuration file may be cause an error before the service stops trying to load it.
 -->

<IdPConfig xmlns="urn:mace:shibboleth:2.0:idp:services" xmlns:service="urn:mace:shibboleth:2.0:services"
    xmlns:profile="urn:mace:shibboleth:2.0:profile-handler" xmlns:relyingParty="urn:mace:shibboleth:2.0:relying-party"
    xmlns:resolver="urn:mace:shibboleth:2.0:resolver" xmlns:afp="urn:mace:shibboleth:2.0:afp"
    xmlns:resource="urn:mace:shibboleth:2.0:resource" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:schemaLocation="urn:mace:shibboleth:2.0:idp:services classpath:/schema/shibboleth-2.0-idp-service.xsd
                        urn:mace:shibboleth:2.0:services classpath:/schema/shibboleth-2.0-services.xsd
                        urn:mace:shibboleth:2.0:profile-handler classpath:/schema/shibboleth-2.0-profile-handler.xsd
                        urn:mace:shibboleth:2.0:relying-party classpath:/schema/shibboleth-2.0-relying-party.xsd
                        urn:mace:shibboleth:2.0:resolver classpath:/schema/shibboleth-2.0-attribute-resolver.xsd
                        urn:mace:shibboleth:2.0:afp classpath:/schema/shibboleth-2.0-afp.xsd 
                        urn:mace:shibboleth:2.0:resource classpath:/schema/shibboleth-2.0-resource.xsd">

    <LoggingConfiguration>$IDP_HOME$/conf/logging.xml</LoggingConfiguration>

    <Service id="shibboleth.ProfileHandler"
             xmlns="urn:mace:shibboleth:2.0:services"
             xsi:type="profile:ShibbolethProfileHandlerManager"
             configurationResourcePollingFrequency="300000"
             configurationResourcePollingRetryAttempts="10">
        <ConfigurationResource file="$IDP_HOME$/conf/protocol.xml" xsi:type="resource:FilesystemResource" />
    </Service>

    <Service id="shibboleth.RelyingPartyConfigurationManager"
             xmlns="urn:mace:shibboleth:2.0:services"
             xsi:type="relyingParty:SAMLMDRelyingPartyConfigurationManager"
             configurationResourcePollingFrequency="300000"
             configurationResourcePollingRetryAttempts="10">
        <ConfigurationResource file="$IDP_HOME$/conf/relying-party.xml" xsi:type="resource:FilesystemResource" />
    </Service>

    <Service id="shibboleth.AttributeResolver"
             xmlns="urn:mace:shibboleth:2.0:services"
             xsi:type="resolver:ShibbolethAttributeResolver"
             configurationResourcePollingFrequency="300000"
             configurationResourcePollingRetryAttempts="10">
        <ConfigurationResource file="$IDP_HOME$/conf/attribute-resolver.xml" xsi:type="resource:FilesystemResource" />
    </Service>

    <Service id="shibboleth.AttributeFilterEngine"
             xmlns="urn:mace:shibboleth:2.0:services"
             xsi:type="afp:ShibbolethAttributeFilteringEngine"
             configurationResourcePollingFrequency="60000"
             configurationResourcePollingRetryAttempts="10">
        <ConfigurationResource file="$IDP_HOME$/conf/attribute-filter.xml" xsi:type="resource:FilesystemResource" />
    </Service>

</IdPConfig>